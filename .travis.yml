language: node_js
sudo: required
node_js:
- '10'
install:
- npm ci
jobs:
  include:
  - stage: Deploy cloud.redhat.com
    script: echo "doing insights stuff"
  - stage: Standalone release
    # script: npm run build-standalone && tar -czvf ui-release.tar.gz dist/ && ls
    script: touch ui-release.tar.gz
    skip_cleanup: true
    deploy:
      provider: releases
      api_key:
        secure: "Go9FoymwU5zShSwdQrjFuEf/hbGbgy9i9GiRuHEAhIgThQdnkGTRTMGs/xmjViwp4jrkN+gZhCMdlrPMxuLKJxNFdsJ9m2hHmICIAZaiL9SmVYTUkrtQauwnh0v191b4u2bLECwMxOJrWliyKBNTYIrJZgsCVbh5WYZLIPJDIdNo6OhUYUH3wFniSacwPibsfkce9Y57znLUc949XoqeAwDkRBJgtPpEzOWRNzv+G3ISOmwfo9LcjH5Uaj5DWVSsYMrJu04pUG0KtXZvGt74jJlfSxnuaYrcKmpVvs41rupZoJhTgKrAHToAYiVMPvgeVZ7HwlbUdcwOpg5yWZ5sQ4DNlyo0g9zoCYf5PWx72nFZzA8rltd673/NCQVbX3i2KTEVIQxtmHlBPC/RMIn1qArk9dN2x24yS6qw4qztVpum+RpNjJi0eKbPvY3DebfYgoQsc3O2Pklt4A45GdMnBvmHU5wiV+CWb9pdrTCvrKIn/HW+uKOZGU+0EI14H4czLuUpvx9YhujUnOJwiWfm0CPyE1Z7Onyg/5hCt9j1ltm93zlg2Rr8C7ZS/GgRroEvyISnaHCkQu6BmwleqlPBXgaKWkB0+VlIgGIEL58d+NoGr6L8t+1mHW12LjvwwEKk1R/aV+MDEXtBQYYYYgDpHei9zlEj/buEPA50E/3j/3w="      file: ui-release.tar.gz
      on:
        branch: feature/standalone-releases
env:
  global:
  - REPO="git@github.com:RedHatInsights/ansible-hub-ui-build.git"
  - REPO_DIR="ansible-hub-ui-build"
  - BRANCH=${TRAVIS_PULL_REQUEST_BRANCH:-$TRAVIS_BRANCH}
  - NODE_OPTIONS="--max-old-space-size=4096 --max_old_space_size=4096"
