language: node_js
sudo: required
node_js:
- '10'
install:
- npm ci
jobs:
  include:
  - stage: Deploy cloud.redhat.com
    script: echo "doing insights stuff"
  - stage: Standalone release
    # script: npm run build-standalone && tar -czvf ui-release.tar.gz dist/ && ls
    script: touch ui-release.tar.gz
    skip_cleanup: true
    deploy:
      provider: releases
      api_key: 830bda028806c90690a441a43a1217d93c094f74
      file: ui-release.tar.gz
      on:
        branch: feature/standalone-releases
env:
  global:
  - REPO="git@github.com:RedHatInsights/ansible-hub-ui-build.git"
  - REPO_DIR="ansible-hub-ui-build"
  - BRANCH=${TRAVIS_PULL_REQUEST_BRANCH:-$TRAVIS_BRANCH}
  - NODE_OPTIONS="--max-old-space-size=4096 --max_old_space_size=4096"
